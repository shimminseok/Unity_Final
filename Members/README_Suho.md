
## 스킬구현 

### 설계목표
- 스킬의 대상, 데미지 이펙트와 버프이펙트, VFX와 SFX를 유연하게 적용하여 다양한 스킬을 만들 수 있도록 범용적인 구현방식.
- 내부적인 스킬구조를 몰라도 스킬데이터를 만들 수 있도록 구현
- 

### 스킬데이터 구현방법

SO데이터포맷으로 고유스킬ID값, 스킬 이름, 스킬 설명, 스킬아이콘, 스킬애니메이션, 스킬쿨타임과 스킬재사용가능횟수 등을 저장하는 ActiveSkillSo클래스를 구현.



<hr>

### SkillData
ActiveSkillSO이라는 스킬데이터를 통해 실제로 사용되는 SKillData클래스를 생성.
SKillData에서는 턴 종료마다 쿨타임을 돌려주는 역할과 해당스킬을 사용가능한 상태인지 아닌 지를 판별.

<hr>

### PoolableVFX

VFX에 ObjectPool을 적용하여, 처음 스킬을 사용할때 VFX를 Instantiate로 생성하여 사용하고 이후 다시 해당 스킬을 사용시에 VFX를 ObjectPool에서 가져와서 재사용.
VFX가 발생할 때, VFX가 발생할 트랜스 폼, 타이밍, 기준위치(적 타겟위치에서 이펙트가 발생할 지, 공격자 위치에서 이펙트가 발생할 지)가 스킬마다 모두 제각각이기 때문에 스킬데이터에 이를 저장할때 이와 관련된 모든 정보를 갖는 VFXData클래스로 저장.
VFXData를 통해 실제로 VFX가 출력될 때는 PoolableVFX를 달고있는 프리펩을 생성 후 이펙트가 발생. 이후, VFX의 Play완료시점을 코루틴으로 받아 이를 ObjectPool에 반환.

<hr>

### 스킬의 적용 타이밍

근거리 스킬의 경우 애니메이션의 이벤트트리거를 통해서 스킬 효과를 적용할 타이밍을 정할 수 있기 때문에 따로 고려하지않아도 괜찮지만, 원거리 스킬의 경우 투사체가 존재.

스킬의 투사체에 적중하는 경우 효과가 발생해야 하므로, 투사체에 스킬정보를 담아서 대상에게 발사하여 투사체와 타겟이 적중할 경우 triggerEnter를 통해서 트리거충돌을 감지하고 스킬 효과를 발생시킴.

<hr>

### PoolableProjectile


<hr>

## 적대치 시스템

아군의 Aggro 스텟에 따라서 적 유닛의 타겟이 될 확률이 바뀌는 적대치시스템을 생성.
Weighted Selector라는 제네릭 클래스를 만들어 해당 기능을 구현.


#### Weighted Selector

엔트리들을 리스트에 집어넣을 때, 유효한 엔트리인지 확인하는 메서드와 해당 엔트리의 확률가중치를 구하는 메서드를 콜백으로 받음.

이후 리스트에서 엔트리를 뽑을 때, 유효한 엔트리들 중에서 확률가중치 비율대로 확률을 구하여 엔트리를 뽑을 수 있음.

**해당 기능은 적 스킬사용로직에도 사용**

### 적 스킬사용 로직

적들의 경우에는 전투시작턴에서 스킬을 사용할 지, 일반공격을 사용할 지 미리 선택.
적 유닛별로 스킬사용확률이 있고 각각의 스킬별로 스킬사용확률가중치가 존재하기때문에 가중치확률별로 스킬을 선택하게됨.

<hr>

### 
